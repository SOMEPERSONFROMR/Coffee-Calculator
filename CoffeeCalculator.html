<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>حاسبة القهوة</title>
  <!-- Google Fonts for the title -->
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #f3e9d2; /* Light coffee cream background */
      color: #3e2723;           /* Dark coffee text */
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
      position: relative;
      overflow-x: hidden;
    }
    /* Bean container is placed behind everything */
    #bean-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }
    .container {
      max-width: 400px;
      background-color: #fff;
      border: 2px solid #6f4e37; /* Coffee brown border */
      border-radius: 10px;
      padding: 20px;
      margin: 20px auto;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    /* Title font styling based on language */
    #title.arabic {
      font-family: 'Cairo', sans-serif;
      font-size: 2em;
    }
    #title.english {
      font-family: 'Pacifico', cursive;
      font-size: 2em;
    }
    label {
      display: block;
      margin: 10px auto;
      text-align: center;
    }
    .input-group {
      margin: 10px auto;
      text-align: center;
    }
    .input-label {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      margin-bottom: 5px;
    }
    select, input[type="number"] {
      padding: 8px;
      width: 90%;
      box-sizing: border-box;
      border: 1px solid #6f4e37;
      border-radius: 5px;
      text-align: center;
    }
    select {
      text-align-last: center; /* Centers the selected option */
    }
    option {
      text-align: center;
    }
    #result {
      margin-top: 20px;
      font-weight: bold;
    }
    /* Timer section styling */
    #timerSection {
      margin-top: 20px;
      text-align: center;
    }
    #timerDisplay {
      font-size: 1.5em;
      margin-bottom: 10px;
    }
    #timerSection button {
      margin: 5px;
      padding: 8px 12px;
      background-color: #6f4e37;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #langToggle {
      margin-bottom: 20px;
      padding: 8px 16px;
      background-color: #6f4e37;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    footer {
      margin-top: 30px;
      font-size: 14px;
      color: #6f4e37;
      text-align: center;
    }
  </style>
</head>
<body>
  <!-- Background bean container -->
  <div id="bean-container"></div>

  <div class="container">
    <button id="langToggle"></button>
    <h1 id="title">حاسبة القهوة</h1>

    <label id="ratioLabel" for="ratio">اختر النسبة (قهوة:ماء):</label>
    <select id="ratio">
      <option value="10">1:10 - مستوى الطعم: قوي جداً</option>
      <option value="11">1:11 - مستوى الطعم: قوي</option>
      <option value="12">1:12 - مستوى الطعم: متوسط</option>
      <option value="13">1:13 - مستوى الطعم: متوازن</option>
      <option value="14">1:14 - مستوى الطعم: سلس</option>
      <option value="15" selected>1:15 - مستوى الطعم: قياسي</option>
      <option value="16">1:16 - مستوى الطعم: خفيف</option>
      <option value="17">1:17 - مستوى الطعم: أخف</option>
      <option value="18">1:18 - مستوى الطعم: أخف جداً</option>
    </select>

    <!-- Water input group -->
    <div class="input-group" id="waterGroup">
      <div class="input-label">
        <label id="waterLabel" for="water">الماء:</label>
        <select id="waterUnit"></select>
      </div>
      <input type="number" id="water" placeholder="ادخل كمية الماء">
    </div>

    <!-- Coffee input group -->
    <div class="input-group" id="coffeeGroup">
      <div class="input-label">
        <label id="coffeeLabel" for="coffee">القهوة:</label>
        <select id="coffeeUnit"></select>
      </div>
      <input type="number" id="coffee" placeholder="ادخل كمية القهوة">
    </div>

    <p id="result"></p>

    <!-- Timer Section -->
    <div id="timerSection">
      <p id="timerDisplay">00:00</p>
      <button id="startTimer">Start Timer</button>
      <button id="resetTimer">Reset Timer</button>
    </div>
  </div>

  <footer id="footer"></footer>

  <!-- Audio elements: one for pep sound and one for start sound -->
  <audio id="pepSound" src="pep.mp3" preload="auto"></audio>
  <audio id="startSound" src="startpep.mp3" preload="auto"></audio>

  <script>
    /* Generate random coffee-themed icons in the background */
    (function generateBeans() {
      const container = document.getElementById("bean-container");
      const beanCount = 10; // Number of each icon to generate
      const images = ['mybean.svg', 'grinder.svg', 'cup.svg', 'coffeemaker.svg', 'barista.svg'];
      images.forEach(src => {
        for (let i = 0; i < beanCount; i++) {
          const img = document.createElement("img");
          img.src = src;
          img.style.position = "absolute";
          img.style.width = (Math.random() * 30 + 20) + "px"; // Random width between 20 and 50px
          img.style.top = (Math.random() * 100) + "%";
          img.style.left = (Math.random() * 100) + "%";
          img.style.opacity = 0.3; // Light opacity
          img.style.pointerEvents = "none";
          container.appendChild(img);
        }
      });
    })();

    // Translation texts for Arabic and English, including unit options
    const translations = {
      ar: {
        title: "حاسبة القهوة",
        ratioLabel: "اختر النسبة (قهوة:ماء):",
        waterLabel: "الماء:",
        coffeeLabel: "القهوة:",
        waterUnitOptions: { "ml": "مل", "oz": "أوقية" },
        coffeeUnitOptions: { "g": "غرام" },
        options: {
          "10": "1:10 - مستوى الطعم: قوي جداً",
          "11": "1:11 - مستوى الطعم: قوي",
          "12": "1:12 - مستوى الطعم: متوسط",
          "13": "1:13 - مستوى الطعم: متوازن",
          "14": "1:14 - مستوى الطعم: سلس",
          "15": "1:15 - مستوى الطعم: قياسي",
          "16": "1:16 - مستوى الطعم: خفيف",
          "17": "1:17 - مستوى الطعم: أخف",
          "18": "1:18 - مستوى الطعم: أخف جداً"
        },
        resultWater: "لـ {water} {wunit} من الماء بنسبة 1:{ratio}، استخدم {coffee} {cunit} من القهوة.",
        resultCoffee: "لـ {coffee} {cunit} من القهوة بنسبة 1:{ratio}، استخدم {water} {wunit} من الماء.",
        waterPlaceholder: "ادخل كمية الماء",
        coffeePlaceholder: "ادخل كمية القهوة",
        toggleLang: "English",
        footerLine1: "استمتع بقهوتك",
        footerLine2: "بواسطة تميم",
        startTimer: "ابدأ المؤقت",
        resetTimer: "إعادة المؤقت"
      },
      en: {
        title: "Coffee Calculator",
        ratioLabel: "Select Ratio (coffee:water):",
        waterLabel: "Water:",
        coffeeLabel: "Coffee:",
        waterUnitOptions: { "ml": "ml", "oz": "oz" },
        coffeeUnitOptions: { "g": "g" },
        options: {
          "10": "1:10 - Very Robust",
          "11": "1:11 - Robust",
          "12": "1:12 - Strong",
          "13": "1:13 - Balanced",
          "14": "1:14 - Smooth",
          "15": "1:15 - Standard",
          "16": "1:16 - Mellow",
          "17": "1:17 - Light",
          "18": "1:18 - Very Light"
        },
        resultWater: "For {water} {wunit} of water at a 1:{ratio} ratio, use {coffee} {cunit} of coffee.",
        resultCoffee: "For {coffee} {cunit} of coffee at a 1:{ratio} ratio, use {water} {wunit} of water.",
        waterPlaceholder: "Enter water",
        coffeePlaceholder: "Enter coffee",
        toggleLang: "العربية",
        footerLine1: "Enjoy Your Coffee",
        footerLine2: "By Tamim",
        startTimer: "Start Timer",
        resetTimer: "Reset Timer"
      }
    };

    let currentLang = 'en';

    // Get DOM elements
    const title = document.getElementById('title');
    const ratioLabel = document.getElementById('ratioLabel');
    const waterLabel = document.getElementById('waterLabel');
    const coffeeLabel = document.getElementById('coffeeLabel');
    const ratioSelect = document.getElementById('ratio');
    const waterInput = document.getElementById('water');
    const coffeeInput = document.getElementById('coffee');
    const waterUnitSelect = document.getElementById('waterUnit');
    const coffeeUnitSelect = document.getElementById('coffeeUnit');
    const result = document.getElementById('result');
    const langToggle = document.getElementById('langToggle');
    const footer = document.getElementById('footer');
    const startTimerBtn = document.getElementById('startTimer');
    const resetTimerBtn = document.getElementById('resetTimer');
    const timerDisplay = document.getElementById('timerDisplay');
    const pepSound = document.getElementById('pepSound');
    const startSound = document.getElementById('startSound');

    // Timer variables
    let timerInterval = null;
    let elapsedSeconds = 0;

    // Update page text and populate unit selectors based on current language
    function updateLanguage() {
      const texts = translations[currentLang];
      title.textContent = texts.title;
      ratioLabel.textContent = texts.ratioLabel;
      waterLabel.textContent = texts.waterLabel;
      coffeeLabel.textContent = texts.coffeeLabel;
      waterInput.placeholder = texts.waterPlaceholder;
      coffeeInput.placeholder = texts.coffeePlaceholder;
      langToggle.textContent = texts.toggleLang;
      startTimerBtn.textContent = texts.startTimer;
      resetTimerBtn.textContent = texts.resetTimer;

      // Update the title's font based on language
      title.className = (currentLang === 'ar') ? 'arabic' : 'english';

      // Update ratio options text
      for (let i = 0; i < ratioSelect.options.length; i++) {
        const option = ratioSelect.options[i];
        const value = option.value;
        option.textContent = texts.options[value];
      }

      // Populate water unit selector
      waterUnitSelect.innerHTML = "";
      for (let key in texts.waterUnitOptions) {
        const option = document.createElement('option');
        option.value = key;
        option.textContent = texts.waterUnitOptions[key];
        waterUnitSelect.appendChild(option);
      }
      // Populate coffee unit selector
      coffeeUnitSelect.innerHTML = "";
      for (let key in texts.coffeeUnitOptions) {
        const option = document.createElement('option');
        option.value = key;
        option.textContent = texts.coffeeUnitOptions[key];
        coffeeUnitSelect.appendChild(option);
      }

      // Update footer content
      footer.innerHTML = `<p>${texts.footerLine1}</p><p>${texts.footerLine2}</p>`;

      // Update document language and text direction
      if (currentLang === 'ar') {
        document.documentElement.lang = 'ar';
        document.documentElement.dir = 'rtl';
      } else {
        document.documentElement.lang = 'en';
        document.documentElement.dir = 'ltr';
      }

      // Clear previous inputs, results, and reset timer
      waterInput.value = "";
      coffeeInput.value = "";
      result.textContent = "";
      resetTimer();
    }

    // Initialize language on page load
    updateLanguage();

    // Toggle language event
    langToggle.addEventListener('click', () => {
      currentLang = currentLang === 'ar' ? 'en' : 'ar';
      updateLanguage();
    });

    // Calculate coffee amount from water input
    function calculateFromWater() {
      const ratio = parseFloat(ratioSelect.value);
      const waterVal = parseFloat(waterInput.value);
      if (!isNaN(waterVal) && waterVal > 0) {
        // Convert water to ml if necessary
        const waterUnit = waterUnitSelect.value;
        const waterML = (waterUnit === 'oz') ? waterVal * 29.5735 : waterVal;
        const coffeeGrams = waterML / ratio;
        // Convert coffee from grams if necessary
        const coffeeUnit = coffeeUnitSelect.value;
        const coffeeVal = (coffeeUnit === 'oz') ? coffeeGrams / 28.3495 : coffeeGrams;
        coffeeInput.value = coffeeVal.toFixed(2);
        // Get display texts from the unit selectors
        const waterUnitDisplay = waterUnitSelect.options[waterUnitSelect.selectedIndex].text;
        const coffeeUnitDisplay = coffeeUnitSelect.options[coffeeUnitSelect.selectedIndex].text;
        if (currentLang === 'ar') {
          result.textContent = `لـ ${waterVal.toFixed(2)} ${waterUnitDisplay} من الماء بنسبة 1:${ratio}، استخدم ${coffeeVal.toFixed(2)} ${coffeeUnitDisplay} من القهوة.`;
        } else {
          result.textContent = `For ${waterVal.toFixed(2)} ${waterUnitDisplay} of water at a 1:${ratio} ratio, use ${coffeeVal.toFixed(2)} ${coffeeUnitDisplay} of coffee.`;
        }
      }
    }

    // Calculate water amount from coffee input
    function calculateFromCoffee() {
      const ratio = parseFloat(ratioSelect.value);
      const coffeeValInput = parseFloat(coffeeInput.value);
      if (!isNaN(coffeeValInput) && coffeeValInput > 0) {
        // Convert coffee to grams if necessary
        const coffeeUnit = coffeeUnitSelect.value;
        const coffeeGrams = (coffeeUnit === 'oz') ? coffeeValInput * 28.3495 : coffeeValInput;
        const waterML = coffeeGrams * ratio;
        // Convert water from ml if necessary
        const waterUnit = waterUnitSelect.value;
        const waterVal = (waterUnit === 'oz') ? waterML / 29.5735 : waterML;
        waterInput.value = waterVal.toFixed(2);
        const waterUnitDisplay = waterUnitSelect.options[waterUnitSelect.selectedIndex].text;
        const coffeeUnitDisplay = coffeeUnitSelect.options[coffeeUnitSelect.selectedIndex].text;
        if (currentLang === 'ar') {
          result.textContent = `لـ ${coffeeValInput.toFixed(2)} ${coffeeUnitDisplay} من القهوة بنسبة 1:${ratio}، استخدم ${waterVal.toFixed(2)} ${waterUnitDisplay} من الماء.`;
        } else {
          result.textContent = `For ${coffeeValInput.toFixed(2)} ${coffeeUnitDisplay} of coffee at a 1:${ratio} ratio, use ${waterVal.toFixed(2)} ${waterUnitDisplay} of water.`;
        }
      }
    }

    // Event listeners for calculations
    waterInput.addEventListener('input', calculateFromWater);
    coffeeInput.addEventListener('input', calculateFromCoffee);
    ratioSelect.addEventListener('change', () => {
      waterInput.value = "";
      coffeeInput.value = "";
      result.textContent = "";
    });
    waterUnitSelect.addEventListener('change', () => {
      if (waterInput.value) calculateFromWater();
    });
    coffeeUnitSelect.addEventListener('change', () => {
      if (coffeeInput.value) calculateFromCoffee();
    });

    // Timer functions
    function updateTimerDisplay() {
      const minutes = Math.floor(elapsedSeconds / 60);
      const seconds = elapsedSeconds % 60;
      timerDisplay.textContent = 
        (minutes < 10 ? "0" + minutes : minutes) + ":" +
        (seconds < 10 ? "0" + seconds : seconds);
    }

    function startTimer() {
      if (timerInterval === null) {
        // Play the start sound when timer starts
        startSound.play();
        timerInterval = setInterval(() => {
          elapsedSeconds++;
          updateTimerDisplay();
          if (elapsedSeconds % 30 === 0 && elapsedSeconds > 0) {
            pepSound.play();
          }
        }, 1000);
      }
    }

    function resetTimer() {
      startSound.play();

      clearInterval(timerInterval);
      timerInterval = null;
      elapsedSeconds = 0;
      updateTimerDisplay();
    }

    // Timer button event listeners
    startTimerBtn.addEventListener('click', startTimer);
    resetTimerBtn.addEventListener('click', resetTimer);
  </script>
</body>
</html>
